---
title: 硬件
date: 2017-01-01 09:00:00
tags: [电脑相关]
---

# 机械硬盘

基本参数：

- **磁头 head**：用来读写数据的探针，每个磁头对应一个盘面。现代硬盘的磁盘通常是双面读写，故磁头数量通常为磁盘数量的两倍。
- **磁道 track**：同一盘面上位于同一半径处的同心圆磁轨。
- **柱面 cylinder**：所有盘面上半径相同的磁道的统称。
- **扇区 sector**：数据存储的基本单位。老式硬盘每个扇区对应的圆心角相等，新式硬盘为节约磁盘空间，改为每个扇区对应的圆周长度相等。 
- **分配单元（旧称“簇”）**：DOS 系统存储文件的基本逻辑单位，为扇区的整数倍，因存储介质的不同、存储介质容量的不同、分区格式的不同而不同。

分区

- MBR（Master Boot Record）分区表格式
    - 磁盘的第1个扇区保存两个数据
        - **主要启动记录区（MBR）**：可以安装开机管理程序的地方
        - **分区表（partition table）**：记录整个硬盘的分区状态
    - 磁盘的第1个扇区中的分区表将磁盘分为**主要（Primary）分区**和**扩展（Extended）分区**，扩展分区的数量为{0,1}
    - 扩展分区的第1个扇区中的分区表将扩展分区分为若干**逻辑（Logical）分区**（此项可选）
- GPT（GUID partition table）分区表格式
    - 为了兼容 512Bytes 和 4K 的扇区，改用**逻辑区块地址（Logical Block Address，LBA）**来定义扇区
        - LBA0（MBR 兼容区块）：分为两个部分。第一部分储存开机管理程序，第二部分放入一个特殊标志，表示此磁盘为 GPT 分区格式。
        - LBA1（GPT 表头记录）：记录了分区表本身的位置和大小，同时记录了备份用的 GPT 分区的位置，并放置了分区表的校验机制码（CRC32）
        - LBA2-33（实际记录分区信息处）：每个 LBA 可以记录 4 个分区记录，每个分区最大 8ZB，最多可有 128 个分区

---
# 固态硬盘

## 怎样延长使用寿命：
1. 确保硬盘读写模式是AHCI。
在AHCI 1.0规范中，Intel引入了NCQ（Native Command Queuing）功能。支持NCQ技术的硬盘在接到读写指令后，会根据指令对访问地址进行重新排序，减少了读取时间，使数据传输更为高效，同时也有效地延长了硬盘的使用寿命。
2. 确保你的电脑开启了TRIM。
一般来说，WIN7以上操作系统都是默认开启的，那如何确认呢？只需要在命令提示符（管理员模式）内输入这串命令：fsutil behavior query DisableDeleteNotify
如果反馈的结果是0，证明是开启了；如果反馈的结果是1，那就代表没有开启，可能就是你的系统出了问题，最好更新下补丁或者重新安装下。顺便提一句，XP系统不支持TRIM哦，所以还是再建议一下：XP系统用SSD比较奢侈。
3. 确保4K对齐。
这个名词，想象大家都很熟悉了~根据测算，4K没有对齐的情况下，SSD的效率会损失一半，寿命也大大减少，所以这是一个非常重要的设置。至于方法，很简单了！只需要用正版的系统镜像安装系统，系统安装过程一定会把4K对齐的！
4. 关闭Windows Search服务和Superfetch服务。
这两项服务更适合速度较慢的机型硬盘，在我们不需要进行搜索或者运行程序的时候，它就已经做了一些“预备工作”，以便我们实际工作时可以更快的响应，而对于SSD来说，完全没有必要，反而增加读写次数，因此还是关掉为好。
方法如下：
    1. 运行Services.msc回车
    2. 找到Windows Search和SuperFetch选项，右键单击属性
    3. 将其停止

## 选购
1. 主控
推荐浦科特、闪迪
2. 闪存
优选MLC。SLC贵，TLC速度略慢寿命略短（相对而言）。
自家生产：Intel、美光、三星、海力士、东芝、闪迪。
使用他家原厂：浦科特、建兴、海盗船等等。
3. 固件
固件影响效率。具备自主研发固件的厂商：Intel、英睿达、浦科特、OCZ、三星等。
4. 缓存
缓存延长寿命，略提高TLC的速度。缓存不必须，若有则越大越好。
5. 性能
4k随机读写速度（4k IOPS）
6. 断电保护
7. 功耗
8. 售后

## 硬盘相关知识科普
**什么是簇？**
　　最开始从WIN98一直到WIN XP，都是机械硬盘的天下，容量有限。而且绝大多数机械硬盘默认扇区都是512K大小。分区的时候有一个东西叫做物理存储单元，俗称簇。分区的时候可以指定这个大小。这个簇不是硬盘的物理结构，而是使用方法。 
　　这个簇很有意思，一个簇只能容纳一个文件，但是一个簇可以包含多个扇区，当时流行小簇，因为小簇不“浪费”磁盘。 打个比方，比如我的簇是10K，文件是25K，我需要保存这个文件需要占用3个簇;那如果簇是5K，那么我想保存该数据，需要使用5个磁盘扇区单元。显得磁盘利用率更高。 
　　那这么看来，是不是簇越小越好呢?不是!因为一个簇是一个磁盘最小的管理存储单元，如果一个文件读了4个单元和400个单元，你觉得哪个更快呢? 而且目前大容量硬盘已经不在乎那几K了，簇这个东西没必要太小。 

**簇和扇区有什么区别？**
　　簇和扇区不是属于一个范畴。簇是系统在硬盘上读写文件时的单位，是一个数据块。而扇区是硬盘划分的最小单位值，就是簇（数据块）占用的地方。
　　簇的大小大于扇区的大小。硬盘每簇的扇区数与硬盘的总容量大小有关。扇区是存储介质上可由硬件寻址的基本单位，x86系统几乎总是定义512字节的扇区大小；簇是许多文件系统格式使用的可寻址数据块，簇的大小总是扇区大小的整数倍，且不同文件系统对于不同大小的卷（分区）会有不同的默认簇大小，比如FAT32对于8GB以下的分区，默认簇大小为4KB，对于8GB～16GB的分区，默认簇大小为16个扇区（8KB），NTFS对于大于2GB的分区，默认簇大小为8个扇区（4KB）。
　　打个比方，你（系统）要在仓库（仓库可视为硬盘）里存放一些书（数据）。你先把书分门别类放到一些大纸箱（簇）里，然后放进仓库，纸箱的体积是根据你仓库大小来决定的，而仓库始终划分成单位为0.1m?的小格子（扇区），仓库大了，纸箱就大些，仓库小了，纸箱就小些。

**存储器中说的块、页、簇、扇区对应的关系是什么？**
　　简单的说，就是块可以包含若干页，页可以包含若干簇，簇可以包含若干扇区。这里“若干”一般是二的方次。例如：一簇等于128扇区，一页等于64簇，一块等于4页，那么一块就等于4x64x128扇区。

**什么是4K?** 
　　绝大多数的机械硬盘默认是512字节的扇区，采用的是DRAM作为存储介质; 而机械硬盘，无论是SLC颗粒还是MLC颗粒，都属于NAND闪存存储单元。 这种硬盘的扇区是4K，这就是4K的由来! 
　　由于win98和win xp大多数采用FAT格式。 这种格式具备32位、16位磁盘格式相互兼容所以被大多数朋友采纳作为系统盘。 但是到了Vista时代，已经不需要16位的DOS了，所以全部采用了纯32位的NTFS格式，NTFS格式也升级到了第五代。 其实XP时代就有NTFS，虽然这种格式性能更高更安全，但是兼容性差，所以一直不作为系统分区，一般作为存储分区。 
　　NTFS格式有一个特性，那就是起始簇的位置! 
　　NTFS分区起始位置不是从0开始，而是从LBA63开始，就是第六十三个扇区开始开始存储。 
　　而且NFTS默认认为扇区是512字节大小，而不是智能调节到第六十三个扇区。 
　　这样问题就来了，63个扇区×512字节=31.5K，也就是说，磁盘的前31.5K是不能被使用的。 
　　使用机械硬盘就算了，使用固态硬盘，存储第一个字，也需要占用31.5K-35.5K之间的磁盘扇区。 
　　最过分的是这样子排列下去，恰好每到一个扇区的4K位置，就会造成一个数据存2个扇区的情况。
　　而且这样排列，只要到了那个能被4K整除的位置就100%占用了2个扇区，哪怕只写一个字。 
　　固态硬盘无论是MLC还是SLC，都是有写入读取次数的，这样极大的损伤了性能和寿命。 而且，增加了读取次数。 这个时候无论簇是多大，都会造成性能和空间的浪费。 
　　所以这个问题就叫做4K! 

**什么是4K对齐？**　　
　　硬盘分区的时候有一个东西叫做物理存储单元，俗称簇。分区的时候可以指定这个大小。这个簇不是硬盘的物理结构，而是使用方法。随着时代发展，硬盘容量不断扩展，使得之前定义的每个扇区512字节不再是那么的合理，于是将每个扇区512字节改为每个扇区4096 个字节，也就是现在常说的“4K扇区”。随着NTFS成为了标准的硬盘文件系统，其文件系统的默认分配单元大小（簇）也是4096字节，为了使簇与扇区相对应，即使物理硬盘分区与计算机使用的逻辑分区对齐，保证硬盘读写效率，所以，有了“4K对齐”的概念。　　传统硬盘的每个扇区固定是512字节，新标准的"4K扇区"的硬盘，硬盘厂商为了保证与操作系统兼容性，也将扇区模拟成512B扇区，这时就会有4K扇区和4K簇不对齐的情况发生。所以就要用“4K对齐的方式，将硬盘模拟扇区对齐成“4k扇区”。“4K对齐”就是将硬盘扇区对齐到8的整数倍个模拟扇区，即512B*8=4096B，4096字节即是4K。所以只要是8的倍数都是4K对齐了。

---
